<!DOCTYPE html>
<html>
    <head>
        <title> Geo Data </title>
    </head>
    <style>
        body{
             padding: 40px;
             text-align: center;
        }
        h2{
            font-family: Impact, Haettenschweiler, 'Arial Narrow Bold', sans-serif;
            text-transform: uppercase;
            color: #2f4dfc;
            text-align: center;
            font-size: 50px;
            margin-bottom: 20px;
            letter-spacing:0.1cm;
        }
        span{
            font-family: Arial, Helvetica, sans-serif;
            font-size: 28px;
            width:30%; 
            margin: auto; 
            margin-bottom: 20px;
        }
        .print{
            width: 150px;
            background-color: #ff6600; 
            color: white; 
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-weight: bolder;
            font-size: 15px;
            padding: 8px; 
            border-radius: 10px;
            margin-top: 30px;
        }
    </style>
    <body>
        <script>
            function sucess(pos){
                const cord = pos.coords;
                console.log('latitude: ' + cord.latitude);
                console.log('longitude:' + cord.longitude);
                
                coordinatesTextLatitude = document.getElementById('display-cords-latitude');
                coordinatesTextLatitude.innerText = +cord.latitude;

                coordinatesTextLangitude = document.getElementById('display-cords-longitude')
                coordinatesTextLangitude.innerText = +cord.longitude;

                getAddress(cord.latitude, cord.longitude);
            }

            function getAddress(lat, lon){
                var openStreetUrl = "https://nominatim.openstreetmap.org/reverse?format=json";
                const paramsSeparator = '&';
                const equal = '=';
                const latKey = 'lat';
                const lonkey = 'lon';

                openStreetUrl = openStreetUrl + 
                                paramsSeparator + latKey + equal + lat + 
                                paramsSeparator + lonkey + equal + lon;  
                //console.log(openStreetUrl);

                fetch(openStreetUrl)
                    .then(response => {
                        return response.json();
                    })
                    .then(data =>{
                        cityName = data.address.city;
                        coordinatesTextCity = document.getElementById('display-cords-city');
                        coordinatesTextCity.innerText = cityName;

                        stateName = data.address.state;
                        coordinatesTextState = document.getElementById('display-cords-state');
                        coordinatesTextState.innerText = stateName;

                        postCodeName = data.address.postcode;
                        coordinatesTextPostCode = document.getElementById('display-cords-postcode');
                        coordinatesTextPostCode.innerText = postCodeName;
                    }) 
            }

            function error(err) {
                  console.error(err);
                  alert("Unable to retrieve location. Please allow location access")
            }

             function CurrentPosition(event){
                event.preventDefault();
                navigator.geolocation.getCurrentPosition(sucess,error);
            }
            
        </script>
    
        <h2 id="map-title">Geo-Data üìç</h2>

        <div>
        <br>
            <span>Latitude: </span>
            <span id="display-cords-latitude"></span>
        <br>
            <span>Longitude: </span>
            <span id="display-cords-longitude"></span>
        <br>
        <br>
            <span>City: </span>
            <span id="display-cords-city"></span>
        <br>
        <br>
            <span>State: </span>
            <span id="display-cords-state"></span>
        <br>
         <br>
            <span>Postal Code: </span>
            <span id="display-cords-postcode"></span>
        <br>
        </div>

        <input class= 'print' type="button" value="GET POSITION" onclick= "CurrentPosition(event)">
    </body>
</html>